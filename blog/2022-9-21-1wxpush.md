---
slug: wxpush
title: 自动推送微信消息和课表
authors: Chengzihan
tags: [python, 爬虫,GitHub Actions,workflows,腾讯云]
---
## 前言

在上一篇博客中，我介绍了写好的爬取课程表的代码，但是这个代码只能在本地运行，但是现在我希望可以使用微信来进行课程提醒。但是配置服务器无疑是比较麻烦的，经过分析我发现定时任务和代码执行都可以使用 GitHub Action 执行。所以我就想到了使用 GitHub Actions 及 GitHub API 来实现这个功能。**本篇文章将介绍如何使用我的代码实现课程与每日天气自动推送**。

## 涉及的工具和技术

- Python
- GitHub Actions
- 微信公众平台开发
- 腾讯云函数 SCF

## GitHub Actions 介绍

![1](https://jetzihan-img.oss-cn-beijing.aliyuncs.com/blog/20220921130548.png)

GitHub Action 是 GitHub 提供的一项功能，可以在 GitHub 上运行自定义的脚本，可以用来自动化构建、测试、打包、发布或部署任何项目。GitHub Action 是 GitHub 为开发者提供的一项功能，可以在 GitHub 上运行自定义的脚本，可以用来自动化构建、测试、打包、发布或部署任何项目。

## 微信公众测试号

### 注册

我们要使用微信公众号来帮助我们传递消息。但是一般个人能注册的**订阅号**是不能满足我们的要求的，每天只能推送一条图文消息。但是微信为我们提供了**测试号**，测试号可以满足我们的需求，毕竟课表推送我们仅仅个人使用，不需要太多的人数。所以一个测试号就够了。  

首先打开[微信公众平台测试号注册](https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&t=sandbox/index)。扫码登录后，点击**立即开通**，然后填写信息，就可以注册完成了。

### 扫码关注

在界面上找到二维码，让需要使用的用户扫码关注。  

![2](https://jetzihan-img.oss-cn-beijing.aliyuncs.com/blog/1663747160731.png)

## 获取高德天气 API

### 注册

打开[高德开放平台](https://lbs.amap.com/)，点击**右上角注册**，然后填写信息，就可以注册完成了。  

### 创建应用

注册成功后，打开控制台，在左侧选择**应用管理**，点击**我的应用**，然后在右上角选择**创建新任务**。  

![1](https://jetzihan-img.oss-cn-beijing.aliyuncs.com/blog/1663747692810.png)

## 在 GitHub 上 Fork 本项目

打开本项目 [仓库地址](https://github.com/inannan423/wx_weather_class_push)，点击右上角 **Fork** 并顺便点击 **Star** 纳入你的收藏，就可以将本项目全部代码复制到你的仓库中了。  

![2](https://jetzihan-img.oss-cn-beijing.aliyuncs.com/blog/1663744534290.png)

然后，克隆源代码到你的本地。  

## 在线编辑项目源代码

但是，实际上我们并不需要做过多修改，只需要一点点的参数修改就可以完成项目的构建了。那么，克隆在本地也就不再必要了，这里将为希望省事的人或者不会使用 Git 的人提供一个方法，直接在 GitHub 上修改代码。  

GitHub 提供了一种能力叫做 **GitHub Codespaces**，可以在**浏览器**中直接修改代码，不需要下载任何东西。我们只需要把你刚刚克隆的仓库 `<你的昵称>/wx_weather_class_push` 中浏览器上方导航栏的链接中 `github.com` 改为 `github.dev` ，就可以启动在线 VScode ，便于你在浏览器中修改代码了。  

```bash
https://github.com/<你的GitHub昵称>/wx_weather_class_push
```

修改后：  

```bash
https://github.dev/<你的GitHub昵称>/wx_weather_class_push
```

启动过程，请稍等片刻：  

![2](https://jetzihan-img.oss-cn-beijing.aliyuncs.com/blog/20220921152948.png)

启动成功，出现编辑器界面：  

![3](https://jetzihan-img.oss-cn-beijing.aliyuncs.com/blog/20220921153019.png)

:::tip
右下角可能提示让你安装 Python 依赖，安装即可。
:::

字太小了，我们可以把字体放大一点。点击左下角的设置图标。将文字大小设置为 20.可以按照自己的喜好设置。

![1](https://jetzihan-img.oss-cn-beijing.aliyuncs.com/blog/1663745545141.png)

## 修改配置

本项目提供了两种功能，可以每天早上道早安每天晚上道晚安同时在每节课开始前可以推送课程信息。这两个内容互相独立，可以只执行一个，也可以两者都执行。  

### 修改早安推送代码

早安推送代码对应文件 `morning.py`。在左侧文件栏中找到 `morning.py`，点击打开。

![2](https://jetzihan-img.oss-cn-beijing.aliyuncs.com/blog/20220921154911.png)
